(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{158:function(e,t,a){e.exports=a.p+"static/media/logo.0a58105d.png"},166:function(e,t,a){e.exports=a(391)},173:function(e,t,a){},175:function(e,t,a){},177:function(e,t,a){},180:function(e,t,a){},195:function(e,t){},217:function(e,t){},219:function(e,t){},282:function(e,t){},391:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),o=a(157),c=a.n(o),s=a(36);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));var l=a(22),i=a(24),u={proposals:[]},d=Object(n.createContext)(u),p=d.Provider,m=a(6),f=a.n(m),b=a(9),h=a(59),v=a(394),y=(a(173),a(175),a(177),a(158)),E=a.n(y);var g=function(){return r.a.createElement("nav",{className:"navbar navbar-expand-lg fixed-top "},r.a.createElement("div",{className:"container-fluid"},r.a.createElement("div",{className:"navbar-wrapper"},r.a.createElement("a",{className:"navbar-brand",href:"/"},r.a.createElement("img",{className:"navbar-logo",src:E.a}),r.a.createElement("span",{className:"navbar-title"}," Burn Signal "))),r.a.createElement("div",{className:"collapse navbar-collapse justify-content-end"},r.a.createElement("ul",{className:"navbar-nav"},r.a.createElement("li",{className:"nav-item"},r.a.createElement("a",{className:"nav-link",href:"/"},"Notifications ",r.a.createElement("i",{className:"nav-icon tim-icons icon-bell-55"}))),r.a.createElement("li",{className:"nav-item"},r.a.createElement("a",{className:"nav-link",href:"/"},"Login ",r.a.createElement("i",{className:"nav-login-icon tim-icons icon-minimal-down"})))))))};function w(){return O.apply(this,arguments)}function O(){return(O=Object(b.a)(f.a.mark(function e(){var t,a;return f.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return console.log("TheGraph - getProposals()"),'{\n    newProposalIssueds(where: { name_not_contains: "fae" }) {\n      id\n      issuer\n      deadline\n      name\n      data\n      optionBaddr\n      optionAaddr\n    }\n  }',e.next=4,fetch("https://api.thegraph.com/subgraphs/name/madhur4444/imgovdynamic",{method:"POST",headers:{"Content-Type":"application/json",Accept:"application/json"},body:JSON.stringify({query:'{\n    newProposalIssueds(where: { name_not_contains: "fae" }) {\n      id\n      issuer\n      deadline\n      name\n      data\n      optionBaddr\n      optionAaddr\n    }\n  }'})}).then(function(e){return e.json()}).then(function(e){return e}).catch(function(e){return console.log(e)});case 4:return t=e.sent,console.log("TheGraph - got Proposals."),a={},t.data.newProposalIssueds.forEach(function(e){a[e.id]=Object(l.a)({},e),delete a.id}),e.abrupt("return",a);case 9:case"end":return e.stop()}},e)}))).apply(this,arguments)}function N(e){return j.apply(this,arguments)}function j(){return(j=Object(b.a)(f.a.mark(function e(t){var a,n;return f.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return console.log("GetProposalData(): "+t),a='{ anonymousDeposits (where: {PropName: "'+t+'"}) {\n      id\n      SenderAddr\n      ContriValue\n      PropName\n      Choice\n    }\n  }',e.next=4,fetch("https://api.thegraph.com/subgraphs/name/madhur4444/imgovdynamic",{method:"POST",headers:{"Content-Type":"application/json",Accept:"application/json"},body:JSON.stringify({query:a})}).then(function(e){return e.json()}).then(function(e){return e}).catch(function(e){return console.log(e)});case 4:return n=e.sent,e.abrupt("return",n);case 6:case"end":return e.stop()}},e)}))).apply(this,arguments)}var x=a(392),k=a(393),C=a(37),S=function(e){return Object(C.a)(e.substring(0,10)).reduceRight(function(e,t,a,n){return[].concat(Object(C.a)(e),[n.splice(~~(Math.random()*n.length),1)[0]])},[]).join("")},A=function(e,t){var a=e.concat(t);return a.sort(function(e,t){return e-t}),a.unshift(0),a};function P(e){return V.apply(this,arguments)}function V(){return(V=Object(b.a)(f.a.mark(function e(t){var a,n,r,o,c,s,l,i,u;return f.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:for(a=t.data.anonymousDeposits,n=a.length,r={},o=0,c=0;c<n;c++)s=0,l=0,"yes"===a[c].Choice?s=parseFloat(a[c].ContriValue):l=parseFloat(a[c].ContriValue),void 0===r[a[c].SenderAddr]?r[a[c].SenderAddr]={yesTotalValue:s,noTotalValue:l}:(i=r[a[c].SenderAddr].yesTotalValue+s,u=r[a[c].SenderAddr].noTotalValue+l,r[a[c].SenderAddr]={yesTotalValue:i,noTotalValue:u}),o+=parseFloat(a[c].ContriValue);return e.abrupt("return",{voters:r,totalValue:o});case 6:case"end":return e.stop()}},e)}))).apply(this,arguments)}function T(e){return I.apply(this,arguments)}function I(){return(I=Object(b.a)(f.a.mark(function e(t){var a,n,r,o,c,s;return f.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:a=0,n=0,r=0,o=0,e.t0=f.a.keys(t);case 5:if((e.t1=e.t0()).done){e.next=16;break}if(c=e.t1.value,t.hasOwnProperty(c)){e.next=9;break}return e.abrupt("continue",5);case 9:s=t[c],a+=Math.sqrt(s.yesTotalValue),n+=Math.sqrt(s.noTotalValue),r+=1,o=o+s.yesTotalValue+s.noTotalValue,e.next=5;break;case 16:return e.abrupt("return",{yesCount:a,noCount:n,noUniqueAdresses:r,totalValue:o});case 17:case"end":return e.stop()}},e)}))).apply(this,arguments)}var M=function(e){return"http://api-rinkeby.etherscan.io/api?module=account&action=txlist&address=".concat(e,"&page=1&offset=0&sort=asc&apikey=").concat("5HPMW9M7DTMYBGP9IXR2M8JNUGEM2HNNDI")};function B(e,t){return L.apply(this,arguments)}function L(){return(L=Object(b.a)(f.a.mark(function e(t,a){var n;return f.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=[],e.next=3,fetch(M(t),{method:"GET",headers:{"Content-Type":"application/json",Accept:"application/json"}}).then(function(e){return e.json()}).then(function(e){e.result.forEach(function(e){parseFloat(e.value)>0&&n.push(a?parseFloat(e.value):-1*parseFloat(e.value))})});case 3:return e.abrupt("return",n);case 4:case"end":return e.stop()}},e)}))).apply(this,arguments)}var D=a(60),F=a.n(D),G=["Monday","Tuesday","Wendsday","Thursday","Friday","Saturday","Sunday"],_={BAR_CONFIG:function(e,t){return{type:"horizontalBar",responsive:!0,data:{labels:["Yes","No"],datasets:[{data:e,borderColor:["#338aff","#ff4233"],borderWidth:2,fill:!0}]},options:{legend:{display:!1},scales:{xAxes:[{scaleLabel:{display:!0,labelString:"Wei (ETH)"},ticks:{suggestedMin:0,max:t,callback:function(e,t,a){return e>1e8||e<-1e8?e.toExponential():e}}}]}}}},SPLINE_CONFIG:function(e,t){return{options:{lineTension:100,bezierCurve:!0,legend:{display:!1},scales:{yAxes:[{id:"yAxis1",scaleLabel:{labelString:"Wei (ETH)",display:!0},ticks:{min:-1*t,max:t,callback:function(e,t,a){return e>1e8||e<-1e8?e.toExponential():e}}},{id:"yAxis2",labels:["","Yes","","No",""],type:"category",gridLines:{drawOnChartArea:!1,display:!1}}]}},type:"line",data:e}},SPLINE_STYLE:function(e){return{label:"Data",fill:!0,backgroundColor:e,borderColor:"#d048b6",borderWidth:2,borderDash:[],borderDashOffset:0,pointBackgroundColor:"#d048b6",pointBorderColor:"rgba(255,255,255,0)",pointHoverBackgroundColor:"#d048b6",pointBorderWidth:20,pointHoverRadius:4,pointHoverBorderWidth:15,pointRadius:4}}};var W=function(e){var t=e.chartId;return Object(n.useEffect)(function(){!function(){var a=e.yesVotes,n=e.noVotes,r=A(a,n),o=Math.max.apply(Math,Object(C.a)(r)),c=Math.min.apply(Math,Object(C.a)(r)),s=Math.ceil((.2*o+o)/10*10),i=-1*Math.ceil((.2*c+c)/10*10),u=document.getElementById(t).getContext("2d"),d=i>s?i:s,p=u.createLinearGradient(0,337.5,0,25),m=G.slice(0,r.length);p.addColorStop(1,"rgba(255,51,138,0.225)"),p.addColorStop(.7,"rgba(255,51,138,0.2)"),p.addColorStop(.5,"rgba(255,51,138,0.125)"),p.addColorStop(.2,"rgba(255,51,138,0.075)"),p.addColorStop(0,"rgba(119,52,169,0)");var f={labels:m,datasets:[Object(l.a)({},_.SPLINE_STYLE(p),{data:r})]};new F.a(u,Object(l.a)({},_.SPLINE_CONFIG(f,d)))}()},[e]),r.a.createElement(n.Fragment,null,r.a.createElement("canvas",{id:t}," "))};var H=function(e){var t=e.chartId;return Object(n.useEffect)(function(){!function(){var a=e.yesCount,n=e.noCount,r=document.getElementById(t).getContext("2d"),o=a>n?a:n,c=.2*o+o,s=[a,n];new F.a(r,Object(l.a)({},_.BAR_CONFIG(s,c)))}()},[e]),r.a.createElement(n.Fragment,null,r.a.createElement("canvas",{id:t}," "))};a(180);var q=function(e){var t=Object(n.useState)({yes:[],no:[]}),a=Object(i.a)(t,2),o=a[0],c=a[1],s=Object(n.useState)({yes:[],no:[]}),l=Object(i.a)(s,2),u=l[0],p=l[1],m=Object(n.useState)(!1),v=Object(i.a)(m,2),y=v[0],E=v[1],g=Object(n.useState)(0),w=Object(i.a)(g,2),O=(w[0],w[1]),j=Object(n.useState)(0),C=Object(i.a)(j,2),A=(C[0],C[1]),V=Object(n.useState)(""),I=Object(i.a)(V,2),M=I[0],L=I[1],D=Object(n.useContext)(d).state,F=Object(h.e)().address,G=void 0!==e.location?F:e.id;return Object(n.useEffect)(function(){!function(){var e=Object(b.a)(f.a.mark(function e(){var t,a,n,r,o,s,l,i,u,d,m,b,h;return f.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!(Object.keys(D.proposals).length>0)){e.next=24;break}return t=D.proposals[G],a=t.name,n=t.optionAaddr,r=t.optionBaddr,e.next=4,N(a);case 4:return o=e.sent,e.next=7,P(o);case 7:return s=e.sent,e.next=10,T(s.voters);case 10:return l=e.sent,e.next=13,B(r,!1);case 13:return i=e.sent,e.next=16,B(n,!0);case 16:u=e.sent,d=l.noCount,m=l.yesCount,b=l.uniqueAddresses,h=l.totalValue,c({yes:u,no:i}),p({yes:m,no:d}),O(b),A(h),E(!0),L(a);case 24:case"end":return e.stop()}},e)}));return function(){return e.apply(this,arguments)}}()()},[e]),r.a.createElement("div",{className:"proposalComponent"},r.a.createElement(x.a,null,r.a.createElement(k.a,{sm:"12",md:{size:8,offset:2}},r.a.createElement("div",{className:"card"},r.a.createElement("div",{className:"card-header"},r.a.createElement("div",{className:"proposal-title"},M)),r.a.createElement("div",{className:"card-body"},r.a.createElement("div",{className:"github-detail"},"See GitHub for full details:"),r.a.createElement("div",{className:"vote-options"},r.a.createElement("button",{className:"btn btn-primary btn-simple"},"Yes"),r.a.createElement("button",{className:"btn btn-primary btn-simple"},"No")))))),r.a.createElement(x.a,null,r.a.createElement(k.a,{sm:"12",md:{size:8,offset:2}},r.a.createElement("div",{className:"card"},r.a.createElement("div",{class:"card-header"},r.a.createElement("h3",{class:"card-category"},"Results")),r.a.createElement("div",{className:"card-body"},y&&r.a.createElement(H,{chartId:S(G),yesCount:u.yes,noCount:u.no}))))),r.a.createElement(x.a,null,r.a.createElement(k.a,{sm:"12",md:{size:8,offset:2}},r.a.createElement("div",{className:"card"},r.a.createElement("div",{class:"card-header"},r.a.createElement("h3",{class:"card-category"},"History")),r.a.createElement("div",{class:"card-body"},y&&r.a.createElement(W,{chartId:S(G),yesVotes:o.yes,noVotes:o.no}))))))};var R=function(){var e=Object(n.useContext)(d).state;return r.a.createElement(n.Fragment,null,Object.keys(e.proposals).map(function(e,t){return r.a.createElement(s.b,{to:"/poll/".concat(e)},r.a.createElement(q,{key:e,id:e}))}))},Y=a(161),z=a(162),J=a(165),Q=a(163),U=a(164),X=a(23),$=a(61),K=a.n($);function Z(e,t){return ee.apply(this,arguments)}function ee(){return(ee=Object(b.a)(f.a.mark(function e(t,a){var n,r,o,c;return f.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!window.ethereum){e.next=13;break}return n=new K.a(window.ethereum),e.prev=2,e.next=5,window.ethereum.enable();case 5:t(n),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(2),a(e.t0);case 11:e.next=14;break;case 13:window.web3?(r=window.web3,console.log("Injected web3 detected."),t(r)):(o=new K.a.providers.HttpProvider("http://127.0.0.1:8545"),c=new K.a(o),console.log("No web3 instance injected, using Local web3."),t(c));case 14:case"end":return e.stop()}},e,null,[[2,8]])}))).apply(this,arguments)}var te=function(){return new Promise(function(e,t){"complete"===document.readyState&&(Z(e,t),console.log("Web3 Loaded Ok")),window.addEventListener("load",Object(b.a)(f.a.mark(function a(){return f.a.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:Z(e,t),console.log("Web3 Loaded.");case 2:case"end":return a.stop()}},a)})))})},ae=function(e){function t(e){var a;return Object(Y.a)(this,t),(a=Object(J.a)(this,Object(Q.a)(t).call(this,e))).state={web3:null,accounts:null,contract:null},a.componentDidMount=Object(b.a)(f.a.mark(function e(){var t,n,r;return f.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,console.log("Loading web3..."),e.next=4,te();case 4:return t=e.sent,e.next=7,t.eth.getAccounts();case 7:n=e.sent,"0x6936b81d7629378aabddcf882b2a7fdfff1cd962",r=new t.eth.Contract(ne,"0x6936b81d7629378aabddcf882b2a7fdfff1cd962"),a.setState({web3:t,accounts:n,contract:r}),e.next=17;break;case 13:e.prev=13,e.t0=e.catch(0),alert("Error loading The Graph"),console.error(e.t0);case 17:case"end":return e.stop()}},e,null,[[0,13]])})),a.makeNewVote=a.makeNewVote.bind(Object(X.a)(Object(X.a)(a))),a.updateQuestion=a.updateQuestion.bind(Object(X.a)(Object(X.a)(a))),a.updateDeadline=a.updateDeadline.bind(Object(X.a)(Object(X.a)(a))),a}return Object(U.a)(t,e),Object(z.a)(t,[{key:"makeNewVote",value:function(){var e=Object(b.a)(f.a.mark(function e(){return f.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return console.log("New Vote"),console.log(this.state.question),console.log(this.state.deadline),console.log("Sending transaction..."),e.next=6,this.state.contract.methods.newVoteProposal(this.state.question,"Here is some data",Date.now()+36e5).send({from:this.state.accounts[0]});case 6:console.log("Done?");case 7:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"updateQuestion",value:function(e){this.setState({question:e.target.value})}},{key:"updateDeadline",value:function(e){this.setState({deadline:e.target.value})}},{key:"render",value:function(){return r.a.createElement("div",{className:"App"},r.a.createElement("div",{className:"main-panel"},r.a.createElement("div",{className:"content"},r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"col-md-6"},r.a.createElement("div",{className:"card"},r.a.createElement("div",{className:"card-header"},r.a.createElement("h5",{className:"title"},"Ask a question...")),r.a.createElement("div",{className:"card-body"},r.a.createElement("form",null,r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"col-md-12 pr-md-1"},r.a.createElement("div",{className:"form-group"},r.a.createElement("label",null,"Your Question"),r.a.createElement("input",{type:"text",className:"form-control",placeholder:"Ask Away",onChange:this.updateQuestion})))),r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"col-md-12 pr-md-1"},r.a.createElement("div",{className:"form-group"},r.a.createElement("label",null,"Deadline"),r.a.createElement("input",{type:"text",className:"form-control",placeholder:"Block No",onChange:this.updateDeadline})))))),r.a.createElement("div",{className:"card-footer"},r.a.createElement("button",{type:"submit",className:"btn btn-fill btn-primary",onClick:this.makeNewVote},"Post"))))))))}}]),t}(n.Component),ne=[{constant:!1,inputs:[{name:"_name",type:"string"},{name:"_data",type:"string"},{name:"_deadline",type:"uint64"}],name:"newVoteProposal",outputs:[{name:"",type:"uint256"}],payable:!1,stateMutability:"nonpayable",type:"function"},{inputs:[],payable:!1,stateMutability:"nonpayable",type:"constructor"},{anonymous:!1,inputs:[{indexed:!1,name:"proposalID",type:"uint256"},{indexed:!1,name:"issuer",type:"address"},{indexed:!1,name:"deadline",type:"uint256"},{indexed:!1,name:"name",type:"string"},{indexed:!1,name:"data",type:"string"}],name:"newProposalIssued",type:"event"},{constant:!0,inputs:[{name:"",type:"uint256"}],name:"proposals",outputs:[{name:"issuer",type:"address"},{name:"deadline",type:"uint256"},{name:"name",type:"string"},{name:"data",type:"string"}],payable:!1,stateMutability:"view",type:"function"}];var re=Object(h.f)(function(){var e=Object(n.useContext)(d),t=e.dispatch;return e.state,Object(n.useEffect)(function(){!function(){var e=Object(b.a)(f.a.mark(function e(){var a;return f.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,w();case 2:a=e.sent,t({payload:a,type:"PROPOSAL"});case 4:case"end":return e.stop()}},e)}));return function(){return e.apply(this,arguments)}}()()},[]),r.a.createElement("main",null,r.a.createElement(v.a,null,r.a.createElement(g,null),r.a.createElement(h.a,{path:"/poll/:address",component:q}),r.a.createElement(h.a,{exact:!0,path:"/",component:R}),r.a.createElement(h.a,{path:"/new",component:ae})))});c.a.render(r.a.createElement(function(e){var t=e.children,a=Object(n.useReducer)(function(e,t){switch(t.type){case"PROPOSAL":return Object(l.a)({},e,{proposals:t.payload});default:return e}},u),o=Object(i.a)(a,2),c=o[0],s=o[1];return r.a.createElement(p,{value:{state:c,dispatch:s}},t)},null,r.a.createElement(s.a,{basename:"/"},r.a.createElement(n.Fragment,null,r.a.createElement(re,null)))),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})}},[[166,2,1]]]);
//# sourceMappingURL=main.b9aea6db.chunk.js.map