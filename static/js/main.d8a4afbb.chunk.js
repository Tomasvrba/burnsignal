(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{265:function(e,t,a){e.exports=a.p+"static/media/logo.0a58105d.png"},269:function(e,t,a){e.exports=a(651)},276:function(e,t,a){},278:function(e,t,a){},280:function(e,t,a){},293:function(e,t){},314:function(e,t){},316:function(e,t){},385:function(e,t){},580:function(e,t){},647:function(e,t,a){},649:function(e,t,a){},651:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),c=a(62),o=a.n(c),l=a(21);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));var s=a(26),u=a(12),i={polls:[],web3:void 0,auth:!1,verified:!1},m=Object(n.createContext)(i),p=m.Provider,d=a(3),b=a.n(d),f=a(13),E=a(133),h=a(659),v=(a(276),a(278),a(280),a(77)),g=a(652),y=a(660),O=a(653),j=a(654),N=a(657),w=a(661),x=a(662),k=a(41),C=a.n(k),S=a(655),F=a(656),B="0x61a8598eabb7bddca95d3783c228878cd788e0a9",I=["Monday","Tuesday","Wendsday","Thursday","Friday","Saturday","Sunday"],D={BAR_CONFIG:function(e,t){return{type:"horizontalBar",responsive:!0,data:{labels:["Yes","No"],datasets:[{data:e,borderColor:"#d048b6",borderWidth:2,fill:!0}]},options:{legend:{display:!1},scales:{xAxes:[{scaleLabel:{display:!0,labelString:"Wei (ETH)"},ticks:{suggestedMin:0,max:t,callback:function(e,t,a){return e>1e8||e<-1e8?e.toExponential():e}}}]}}}},SPLINE_CONFIG:function(e,t){return{options:{lineTension:100,bezierCurve:!0,legend:{display:!1},scales:{yAxes:[{id:"yAxis1",scaleLabel:{labelString:"Wei (ETH)",display:!0},ticks:{min:-1*t,max:t,callback:function(e,t,a){return e>1e8||e<-1e8?e.toExponential():e}}},{id:"yAxis2",labels:["","Yes","","No",""],type:"category",gridLines:{drawOnChartArea:!1,display:!1}}]}},type:"line",data:e}},SPLINE_STYLE:function(e){return{label:"Data",fill:!0,backgroundColor:e,borderColor:"#d048b6",borderWidth:2,borderDash:[],borderDashOffset:0,pointBackgroundColor:"#d048b6",pointBorderColor:"rgba(255,255,255,0)",pointHoverBackgroundColor:"#d048b6",pointBorderWidth:20,pointHoverRadius:4,pointHoverBorderWidth:15,pointRadius:4}}},T=[{constant:!1,inputs:[{name:"_name",type:"string"},{name:"_data",type:"string"},{name:"_deadline",type:"uint64"}],name:"newVoteProposal",outputs:[{name:"newProposal",type:"address"}],payable:!1,stateMutability:"nonpayable",type:"function"},{anonymous:!1,inputs:[{indexed:!1,name:"proposal",type:"address"},{indexed:!1,name:"issuer",type:"address"},{indexed:!1,name:"deadline",type:"uint256"},{indexed:!1,name:"name",type:"string"},{indexed:!1,name:"data",type:"string"},{indexed:!1,name:"optionA",type:"string"},{indexed:!1,name:"optionAaddr",type:"address"},{indexed:!1,name:"optionB",type:"string"},{indexed:!1,name:"optionBaddr",type:"address"}],name:"newProposalIssued",type:"event"}],_=a(259),q=a.n(_),L=a(260),A=a.n(L),P=a(261),W=a.n(P),H=a(262),R=a.n(H),M={walletconnect:{package:W.a,options:{infuraId:"INFURA_ID"}},authereum:{package:R.a,options:{}}},z=function(){return new Promise(function(){var e=Object(f.a)(b.a.mark(function e(t,a){var n,r,c;return b.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,n=new A.a.Core({network:"mainnet",cacheProvider:!0,providerOptions:M}),e.next=4,n.connect();case 4:r=e.sent,c=new q.a(r),t(c),e.next=12;break;case 9:e.prev=9,e.t0=e.catch(0),t(e.t0);case 12:case"end":return e.stop()}},e,null,[[0,9]])}));return function(t,a){return e.apply(this,arguments)}}())},G=a(265),V=a.n(G);var Y=Object(E.h)(function(e){var t=Object(n.useState)({question:!1,description:!1}),a=Object(u.a)(t,2),c=(a[0],a[1],Object(n.useState)({create:!1,about:!1})),o=Object(u.a)(c,2),i=o[0],p=o[1],d=Object(n.useState)(r.a.createElement(te,null)),h=Object(u.a)(d,2),k=h[0],I=h[1],D=Object(n.useState)(!1),_=Object(u.a)(D,2),q=_[0],L=_[1],A=Object(n.useState)(r.a.createElement(n.Fragment,null)),P=Object(u.a)(A,2),W=P[0],H=P[1],R=Object(n.useState)(""),M=Object(u.a)(R,2),G=(M[0],M[1],Object(n.useRef)(null)),Y=Object(n.useRef)(null),J=Object(n.useContext)(m),U=J.dispatch,$=J.state,K=Object(E.f)();function Q(){return X.apply(this,arguments)}function X(){return(X=Object(f.a)(b.a.mark(function e(){var t,a,n;return b.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,z();case 3:return t=e.sent,e.next=6,t.eth.getAccounts();case 6:a=e.sent,n=new t.eth.Contract(T,B),U({payload:{web3:t,accounts:a,instance:n,auth:!0,verified:!0},type:"WEB3"}),I(r.a.createElement(ae,{account:a[0]})),H(r.a.createElement(ne,{account:a[0]})),e.next=16;break;case 13:e.prev=13,e.t0=e.catch(0),alert("Web3 login could not be detected");case 16:case"end":return e.stop()}},e,null,[[0,13]])}))).apply(this,arguments)}function Z(e){var t="/".concat(e);K[K.length-1]!==t&&K.push(t),p(Object(s.a)({},i,Object(v.a)({},e,!0)))}function ee(e){K.push("/"),p(Object(s.a)({},i,Object(v.a)({},e,!1)))}function te(){return r.a.createElement(l.b,{to:"/login"},r.a.createElement(g.a,null,"Login"))}function ae(e){var t=e.account;return r.a.createElement(n.Fragment,null,r.a.createElement(g.a,{type:"button",onClick:function(){return Z("create")}}," Create "),r.a.createElement(l.b,{to:"/profile/".concat(t)},r.a.createElement(g.a,null," Profile ")),r.a.createElement(l.b,{to:"/logout"},r.a.createElement(g.a,null,"Logout")))}function ne(e){var t=e.account;return r.a.createElement(l.b,{className:"nav-link",to:"/profile/".concat(t)},r.a.createElement("img",{className:"nav-profile",src:C()(t)}))}var re=function(){var e=Object(f.a)(b.a.mark(function e(){var t,a,n,r,c;return b.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=$.web3,a=$.instance,n=$.accounts,e.next=3,t.eth.getBlock("latest");case 3:return r=e.sent,c=r.timestamp+604800,e.next=7,a.methods.newVoteProposal(Y.current.value,G.current.value,c).send({from:n[0]}).on("transactionHash",function(e){ee("create"),document.getElementsByClassName("create-poll-description")[0].value="",document.getElementsByClassName("create-poll-question")[0].value=""});case 7:case"end":return e.stop()}},e)}));return function(){return e.apply(this,arguments)}}();return Object(n.useEffect)(function(){!function(){var t=Object(f.a)(b.a.mark(function t(){return b.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:e.location&&(e.location.pathname.match("about")?Z("about"):e.location.pathname.match("create")?Z("create"):e.location.pathname.match("login")?(Q(),K.push("/")):e.location.pathname.match("logout")&&(U({payload:{web3:!1,auth:!1,verified:!1},type:"WEB3"}),I(r.a.createElement(te,null)),H(r.a.createElement(n.Fragment,null)),K.push("/")));case 1:case"end":return t.stop()}},t)}));return function(){return t.apply(this,arguments)}}()()},[e.location.pathname]),r.a.createElement(S.a,null,r.a.createElement(F.a,{sm:"12",md:{size:8,offset:2}},r.a.createElement("nav",{className:"navbar navbar-expand-lg fixed-top col-sm-12 col-md-7"},r.a.createElement("div",{className:"navbar-wrapper"},r.a.createElement(l.b,{className:"navbar-brand",to:"/"},r.a.createElement("img",{className:"navbar-logo",src:V.a}),r.a.createElement("span",{className:"navbar-title"}," Burn Signal "))),r.a.createElement("div",{className:"collapse navbar-collapse justify-content-end"},r.a.createElement("ul",{className:"navbar-nav"},r.a.createElement("li",{className:"nav-item"},W,r.a.createElement(N.a,{isOpen:q,toggle:function(){return L(function(e){return!e})}},r.a.createElement(w.a,{caret:!0},r.a.createElement("i",{className:"nav-login-icon tim-icons icon-minimal-down"})),r.a.createElement(x.a,null,r.a.createElement(l.b,{to:"/"},r.a.createElement(g.a,null," Home ")),k,r.a.createElement(g.a,{divider:!0}),r.a.createElement(g.a,{type:"button",onClick:function(){return Z("about")}},"About"),r.a.createElement(g.a,{target:"_",href:"https://blog.burnsignal.io"},"Blog")))))))),r.a.createElement(function(){return r.a.createElement(y.a,{isOpen:i.about},r.a.createElement(O.a,null,r.a.createElement("h5",{className:"modal-title align-left"},"About"),r.a.createElement("button",{type:"button",className:"close",onClick:function(){return ee("about")}},r.a.createElement("span",{"aria-hidden":"true"},"\xd7"))),r.a.createElement(j.a,null,r.a.createElement("p",null,"Burn Signal is an experiment in distributed preference signaling where verified unique users burn ETH to signal their opinion."),r.a.createElement("p",null,"Votes are weighted quadratically."),r.a.createElement("p",null,"We use ",r.a.createElement("a",{target:"_",href:"https://brightid.org"},"BrightID")," as our proof of uniqueness, only votes cast by ethereum addresses that are verified unique by BrightID count towards the outcome of a burn signals."),r.a.createElement("br",null),r.a.createElement("p",null,"Burn Signal is funded by grants and community contributions. If you would like to contribute funds, check out our ",r.a.createElement("a",{target:"_",href:"https://gitcoin.co/grants/138/burner-vote"},"Gitcoin Grants campaign"),", if you would like to contribute code or other work, check out our ",r.a.createElement("a",{target:"_",href:"https://github.com/burnsignal"},"GitHub")," and our ",r.a.createElement("a",{target:"_",href:"https://colony.io/colony/burn"},"Colony"),"."),r.a.createElement("br",null),r.a.createElement("p",null,"Check out our ",r.a.createElement("a",{target:"_",href:"https://blog.burnsignal.io"}," blog ")," for more information.")))},null),r.a.createElement(function(){return r.a.createElement(y.a,{isOpen:i.create},r.a.createElement(O.a,null,r.a.createElement("h5",{className:"modal-title align-left"},"Create"),r.a.createElement("button",{type:"button",className:"close",onClick:function(){return ee("create")}},r.a.createElement("span",{"aria-hidden":"true"},"\xd7"))),r.a.createElement(j.a,null,r.a.createElement("input",{name:"question",ref:Y,placeholder:"What question is on your mind?",className:"create-poll-question"}),r.a.createElement("textarea",{name:"description",ref:G,placeholder:"Description",className:"create-poll-description"}),r.a.createElement("button",{className:"btn btn-primary button-poll",onClick:re}," Create ")))},null))}),J=a(658),U=a(54),$=a(141),K=function(e){return Object(U.a)(e.substring(0,10)).reduceRight(function(e,t,a,n){return[].concat(Object(U.a)(e),[n.splice(~~(Math.random()*n.length),1)[0]])},[]).join("")},Q=function(e){return parseInt(e)>=1e15?"".concat(parseFloat(e/Math.pow(10,18)).toFixed(3)," ETH"):parseInt(e)>=1e6?"".concat((e/1e9).toFixed(3)," GWEI"):parseInt(e)<1e6?"".concat(parseFloat(e).toFixed(2)," WEI"):void 0},X=function(e,t){var a=e.concat(t);return a.unshift(0),a},Z=function(){var e=Object(f.a)(b.a.mark(function e(t){var a;return b.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return a={yes:[],no:[],voters:[]},e.next=3,Object.entries(t).map(function(e){var t=Object(u.a)(e,2),n=(t[0],t[1]),r=n.address,c=n.yes,o=n.no;a.voters.push(r),c.value.forEach(function(e,t){e=parseFloat(e),isNaN(e)&&(e=0),a.yes.push(e)}),o.value.forEach(function(e,t){e=-1*parseFloat(e),isNaN(e)&&(e=0),a.no.push(e)})});case 3:return e.abrupt("return",a);case 4:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),ee=function(e){return"-"===(e=(e=e.replace(/([\u2700-\u27BF]|[\uE000-\uF8FF]|\uD83C[\uDC00-\uDFFF]|\uD83D[\uDC00-\uDFFF]|[\u2011-\u26FF]|\uD83E[\uDD10-\uDDFF])/g,"")).replace(/ /g,"-").toLowerCase()).substring(e.length-1,e.length)&&(e=e.slice(0,e.length-1)),e.replace("?","")},te=function(e){e=e.toLowerCase().replace("0x","");for(var t=Object($.keccak_256)(e),a="0x",n=0;n<e.length;n++)parseInt(t[n],16)>=8?a+=e[n].toUpperCase():a+=e[n];return a};var ae=a(641);var ne=function(e){var t="".concat(ee(e.title),".burnsignal.eth"),a=Object(n.useRef)(null),c=Object(n.useContext)(m).state;e.title;var o=function(){var t=Object(f.a)(b.a.mark(function t(n){var r,o;return b.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return r=c.web3,o=a.current.value%1===0?r.utils.toBN(parseFloat(a.current.value)).mul(r.utils.toBN(1e18)):parseInt(a.current.value*Math.pow(10,18)),t.next=4,r.eth.sendTransaction({to:e.address[n],from:c.accounts[0],value:o}).on("transactionHash",function(){e.modalToggle()});case 4:case"end":return t.stop()}},t)}));return function(e){return t.apply(this,arguments)}}();return r.a.createElement(n.Fragment,null,r.a.createElement(y.a,{isOpen:e.modalState},c.web3&&c.verified&&r.a.createElement(function(t){var c=t.option;return r.a.createElement(n.Fragment,null,r.a.createElement(O.a,null,r.a.createElement("h5",{className:"modal-title"},e.title),r.a.createElement("button",{type:"button",className:"close",onClick:e.modalToggle},r.a.createElement("span",{"aria-hidden":"true"},"\xd7"))),r.a.createElement(j.a,null,r.a.createElement("span",{className:"vote-selection"}," How much ETH will you burn to cast your vote? "),r.a.createElement("input",{type:"number",ref:a,className:"modal-input",placeholder:"0.5 ETH"})),r.a.createElement(J.a,null,r.a.createElement("button",{type:"button",className:"btn btn-primary btn-verify","data-dismiss":"modal",onClick:function(){return o(c)}},"Vote ",c)))},{option:e.modalOption}),!c.web3&&!c.verified&&r.a.createElement(function(a){var c=a.option;return r.a.createElement(n.Fragment,null,r.a.createElement(O.a,null,r.a.createElement("h5",{className:"modal-title"},e.title),r.a.createElement("button",{type:"button",className:"close",onClick:e.modalToggle},r.a.createElement("span",{"aria-hidden":"true"},"\xd7"))),r.a.createElement(j.a,null,"Vote ",r.a.createElement("span",{id:"pink"},c)," by sending any amount of ETH to ",r.a.createElement("br",null),r.a.createElement("a",{target:"_",href:"https://etherscan.io"},r.a.createElement("span",{id:"pink"},c),".",t),r.a.createElement("div",{className:"poll-qr"},r.a.createElement(ae,{value:e.address[c]})),"To ensure that you vote counts, please link your ethereum account to your BrightID account at\u2028 ",r.a.createElement("a",{target:"_",href:"https://ethereum.brightid.org"},"ethereum.brightid.org")))},{option:e.modalOption}),c.web3&&!c.verified&&r.a.createElement(function(){return r.a.createElement(n.Fragment,null,r.a.createElement(O.a,null,r.a.createElement("h5",{className:"modal-title"},"Please verify your account"),r.a.createElement("button",{type:"button",className:"close","data-dismiss":"modal","aria-label":"Close",onClick:e.dismiss},r.a.createElement("span",{"aria-hidden":"true"},"\xd7"))),r.a.createElement(j.a,null,"Before casting your vote, you should verify your Ethereum account using BrightID."),r.a.createElement(J.a,null,r.a.createElement("button",{type:"button",className:"btn btn-primary btn-verify","data-dismiss":"modal"},"Verify")))},null)))},re=function(e){return'{ polls(where: { id: "'.concat(e,'" }) { yes no users { address yes { contributions timestamps total value sqrt } no { contributions timestamps total value sqrt } } } }')},ce='{ issues(where: { title_not_contains: "question" }) { id poll body title issuer deadline optionBaddr optionAaddr } }',oe=function(e){return'{ issues(where: { title: "'.concat(e,'" }) { poll } }')},le=function(e){return'{ user(id: "'.concat(e.toLowerCase(),'") { burns polls burned } }')},se=function(){var e=Object(f.a)(b.a.mark(function e(t){return b.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("https://api.thegraph.com/subgraphs/name/burnsignal/proof-of-concept",Object(s.a)({},(a=t,{method:"POST",headers:{"Content-Type":"application/json",Accept:"application/json"},body:JSON.stringify({query:a})}))).then(function(e){return e.json()}).then(function(e){return e}).catch(console.log);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}var a},e)}));return function(t){return e.apply(this,arguments)}}();function ue(){return ie.apply(this,arguments)}function ie(){return(ie=Object(f.a)(b.a.mark(function e(){var t,a;return b.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,se(ce);case 2:return t=e.sent,a={},t.data.issues.forEach(function(e){a[ee(e.poll)]=Object(s.a)({},e)}),e.abrupt("return",a);case 6:case"end":return e.stop()}},e)}))).apply(this,arguments)}function me(e){return pe.apply(this,arguments)}function pe(){return(pe=Object(f.a)(b.a.mark(function e(t){var a;return b.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,se(oe(t));case 2:if(0!=(a=e.sent).data.issues.length){e.next=7;break}return e.abrupt("return",{id:""});case 7:return e.abrupt("return",a.data.issues[0].poll);case 8:case"end":return e.stop()}},e)}))).apply(this,arguments)}function de(e){return be.apply(this,arguments)}function be(){return(be=Object(f.a)(b.a.mark(function e(t){var a;return b.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,se(re(t));case 2:if(0!=(a=e.sent).data.polls.length){e.next=7;break}return e.abrupt("return",{yes:0,no:0,users:[]});case 7:return e.abrupt("return",a.data.polls[0]);case 8:case"end":return e.stop()}},e)}))).apply(this,arguments)}function fe(e){return Ee.apply(this,arguments)}function Ee(){return(Ee=Object(f.a)(b.a.mark(function e(t){var a;return b.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,se(le(t));case 2:if(null!==(a=e.sent).data.user){e.next=7;break}return e.abrupt("return",{burned:0,polls:[],burns:[]});case 7:return e.abrupt("return",a.data.user);case 8:case"end":return e.stop()}},e)}))).apply(this,arguments)}a(647);var he=function(){var e=Object(n.useState)(0),t=Object(u.a)(e,2),a=t[0],c=t[1],o=Object(n.useState)([]),s=Object(u.a)(o,2),i=s[0],m=s[1],p=Object(n.useState)(0),d=Object(u.a)(p,2),h=d[0],v=d[1],g=Object(n.useState)(0),y=Object(u.a)(g,2),O=y[0],j=y[1],N=Object(E.g)().address;return Object(n.useEffect)(function(){!function(){var e=Object(f.a)(b.a.mark(function e(){var t,a,n,r,o,l,s;return b.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fe(N);case 2:t=e.sent,a=[],n=t.burned,r=t.polls,o=t.burns,l=0;case 6:if(!(l<r.length)){e.next=14;break}return e.next=9,me(r[l]);case 9:s=e.sent,"question"!=r[l]&&a.push({address:s,title:r[l]});case 11:l++,e.next=6;break;case 14:j(Q(parseInt(n)/o.length)),v(o.length),c(Q(n)),m(a);case 18:case"end":return e.stop()}},e)}));return function(){return e.apply(this,arguments)}}()()},[]),r.a.createElement("div",{className:"profile"},r.a.createElement(S.a,null,r.a.createElement(F.a,{sm:"12",md:{size:8,offset:2}},r.a.createElement("div",{className:"card"},r.a.createElement("div",{className:"card-header"},r.a.createElement(l.b,{to:"/profile/".concat(N)},r.a.createElement("img",{className:"profile-blockie",src:C()(N)})),r.a.createElement("div",{className:"profile-stats"},r.a.createElement("div",{className:"profile-address"},r.a.createElement("a",{href:"https://etherscan.io/address/".concat(N)},te(N))),r.a.createElement("span",{className:"profile-stat"},"Burned: ",r.a.createElement("span",{id:"pink"},a)," "),r.a.createElement("span",{className:"profile-stat"},"Burns: ",r.a.createElement("span",{id:"pink"},h)," "),r.a.createElement("span",{className:"profile-stat"},"Average: ",r.a.createElement("span",{id:"pink"},O)," "),r.a.createElement("p",{className:"profile-verified"},"Verified: ",r.a.createElement("span",{id:"pink"},"false")," ")))))),r.a.createElement(S.a,null,r.a.createElement(F.a,{sm:"12",md:{size:8,offset:2}},r.a.createElement("div",{className:"card"},r.a.createElement("div",{className:"card-header"},r.a.createElement("h3",{className:"card-category"},"Polls")),r.a.createElement("div",{className:"card-body"}),r.a.createElement("ul",null,i.map(function(e){return r.a.createElement(l.b,{to:"/poll/".concat(e.address)},r.a.createElement("li",null," ",e.title," "))}))))))},ve=a(96),ge=a.n(ve),ye=function(e,t){var a;return(a=[]).concat.apply(a,Object(U.a)(Array.from({length:t},function(){return e})))};var Oe=function(e){var t=e.chartId;return Object(n.useEffect)(function(){!function(){var a=e.pollRecords,n=a.yes,r=a.no,c=X(n,r),o=Math.max.apply(Math,Object(U.a)(c)),l=Math.min.apply(Math,Object(U.a)(c)),u=Math.ceil((.2*o+o)/10*10),i=-1*Math.ceil((.2*l+l)/10*10),m=document.getElementById(t).getContext("2d"),p=i>u?i:u,d=c.length>I.length?ye(I,parseInt(c.length/I.length)):I.slice(0,c.length),b=m.createLinearGradient(0,337.5,0,25);b.addColorStop(1,"rgba(255,51,138,0.225)"),b.addColorStop(.7,"rgba(255,51,138,0.2)"),b.addColorStop(.5,"rgba(255,51,138,0.125)"),b.addColorStop(.2,"rgba(255,51,138,0.075)"),b.addColorStop(0,"rgba(119,52,169,0)");var f={labels:d,datasets:[Object(s.a)({},D.SPLINE_STYLE(b),{data:c})]};new ge.a(m,Object(s.a)({},D.SPLINE_CONFIG(f,p)))}()},[]),r.a.createElement(n.Fragment,null,r.a.createElement("canvas",{id:t}," "))};var je=function(e){var t=e.chartId;return Object(n.useEffect)(function(){!function(){var a=e.pollCount,n=a.yes,r=a.no,c=document.getElementById(t).getContext("2d"),o=n>r?n:r,l=.2*o+o,u=[n,r];new ge.a(c,Object(s.a)({},D.BAR_CONFIG(u,l)))}()},[]),r.a.createElement(n.Fragment,null,r.a.createElement("canvas",{id:t}," "))};a(649);var Ne=function(e){var t=Object(n.useState)({yes:[],no:[]}),a=Object(u.a)(t,2),c=a[0],o=a[1],i=Object(n.useState)({yes:"",no:""}),p=Object(u.a)(i,2),d=p[0],h=p[1],v=Object(n.useState)({yes:0,no:0}),g=Object(u.a)(v,2),y=g[0],O=g[1],j=Object(n.useState)(""),N=Object(u.a)(j,2),w=N[0],x=N[1],k=Object(n.useState)(!1),B=Object(u.a)(k,2),I=B[0],D=B[1],T=Object(n.useState)(0),_=Object(u.a)(T,2),q=(_[0],_[1]),L=Object(n.useState)(0),A=Object(u.a)(L,2),P=(A[0],A[1],Object(n.useState)("0x")),W=Object(u.a)(P,2),H=W[0],R=W[1],M=Object(n.useState)(""),z=Object(u.a)(M,2),G=z[0],V=z[1],Y=Object(n.useState)(""),J=Object(u.a)(Y,2),U=J[0],$=J[1],Q=Object(n.useState)(""),X=Object(u.a)(Q,2),ee=X[0],ae=X[1],re=Object(n.useContext)(m).state,ce=Object(E.g)().address,oe=Object(E.f)(),le=void 0!==e.location?ce:e.id,se=function(){return $(!U)};function ue(t,a){var n="".concat(e.location.pathname,"/").concat(t);a&&oe[oe.length-1]!==n&&oe.push(n),ae(t),se()}return Object(n.useEffect)(function(){!function(){var e=Object(f.a)(b.a.mark(function e(){var t,a,n,r,c,l,u,i,m,p,d;return b.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(void 0===re.polls[le]){e.next=17;break}return t=re.polls[le],a=t.title,n=t.body,r=t.issuer,c=t.optionAaddr,l=t.optionBaddr,e.next=4,de(a);case 4:return u=e.sent,i=u.yes,m=u.users,p=u.no,e.next=8,Z(m);case 8:d=e.sent,O({yes:parseInt(i),no:parseInt(p)}),h({yes:c,no:l}),R(te(r)),q(d.voters.length),o(Object(s.a)({},d)),x(n),D(!0),V(a);case 17:case"end":return e.stop()}},e)}));return function(){return e.apply(this,arguments)}}()()},[re.polls]),Object(n.useEffect)(function(){e.location&&(e.location.pathname.match("yes")?ue("yes",!1):e.location.pathname.match("no")&&ue("no",!1))},[]),r.a.createElement("div",{className:"poll"},r.a.createElement(S.a,null,r.a.createElement(F.a,{sm:"12",md:{size:8,offset:2}},r.a.createElement("div",{className:"card"},r.a.createElement("div",{className:"card-header"},r.a.createElement(l.b,{className:"poll-issuer",to:"/profile/".concat(H)},r.a.createElement("img",{className:"poll-profile",src:C()(H)})),r.a.createElement("div",{className:"poll-title"},G)),r.a.createElement("div",{className:"card-body"},r.a.createElement("div",{className:"poll-description"},w),r.a.createElement("div",{className:"vote-options"},r.a.createElement("button",{type:"button",className:"btn btn-simple",onClick:function(){return ue("yes",!0)}},"Yes"),r.a.createElement("button",{type:"button",className:"btn btn-simple",onClick:function(){return ue("no",!0)}},"No")))))),r.a.createElement(S.a,null,r.a.createElement(F.a,{sm:"12",md:{size:8,offset:2}},r.a.createElement("div",{className:"card"},r.a.createElement("div",{className:"card-header"},r.a.createElement("h3",{className:"card-category"},"Results")),r.a.createElement("div",{className:"card-body"},I&&r.a.createElement(je,{chartId:K(le),pollCount:y}))))),r.a.createElement(S.a,null,r.a.createElement(F.a,{sm:"12",md:{size:8,offset:2}},r.a.createElement("div",{className:"card"},r.a.createElement("div",{className:"card-header"},r.a.createElement("h3",{className:"card-category"},"History")),r.a.createElement("div",{className:"card-body"},I&&r.a.createElement(Oe,{chartId:K(le),pollRecords:c})))),r.a.createElement(ne,{modalOption:ee,modalToggle:function(){var t=e.location.pathname.replace("/yes","");t=t.replace("/no",""),oe.push(t),se()},modalState:U,title:G,address:d})))};var we=function(){var e=Object(n.useRef)(null),t=Object(n.useRef)(null),a=Object(n.useContext)(m).state,c=function(){var n=Object(f.a)(b.a.mark(function n(){var r,c,o,l,s;return b.a.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return r=a.web3,c=a.instance,o=a.accounts,n.next=3,r.eth.getBlock("latest");case 3:return l=n.sent,s=l.timestamp+604800,n.next=7,c.methods.newVoteProposal(t.current.value,e.current.value,s).send({from:o[0]}).on("transactionHash",function(e){document.getElementsByClassName("create-poll-description")[0].value="",document.getElementsByClassName("create-poll-question")[0].value=""});case 7:case"end":return n.stop()}},n)}));return function(){return n.apply(this,arguments)}}();return r.a.createElement(n.Fragment,null,a.web3&&r.a.createElement("div",{className:"new-poll"},r.a.createElement(S.a,null,r.a.createElement(F.a,{sm:"12",md:{size:8,offset:2}},r.a.createElement("div",{className:"card"},r.a.createElement("div",{className:"card-header"}),r.a.createElement("div",{className:"card-body"},r.a.createElement(l.b,{to:"/profile/".concat(a.accounts[0])},r.a.createElement("img",{className:"new-poll-profile",src:C()(a.accounts[0])})),r.a.createElement(function(){return r.a.createElement(n.Fragment,null,r.a.createElement("input",{ref:t,name:"question",placeholder:"What question is on your mind?",className:"create-poll-question"}),r.a.createElement("textarea",{name:"description",ref:e,placeholder:"Description",className:"create-poll-description"}),r.a.createElement("button",{className:"btn btn-primary button-poll",onClick:c}," Create "))},null)))))),Object.keys(a.polls).reverse().map(function(e,t){return r.a.createElement(l.b,{to:"/poll/".concat(e)},r.a.createElement(Ne,{key:e,id:e}))}))};function xe(){return r.a.createElement("center",null,r.a.createElement("div",{class:"page404"},r.a.createElement("h2",null," 404 not found "),r.a.createElement("label",null," Oops, looks like you've made a wrong turn...",r.a.createElement("br",null),r.a.createElement(l.b,{to:"/"}," Take me back! "))))}var ke=Object(E.h)(function(e){var t=Object(n.useContext)(m),a=t.dispatch;return t.state,Object(n.useEffect)(function(){return window.scrollTo(0,0)},[e.location.pathname]),Object(n.useEffect)(function(){!function(){var e=Object(f.a)(b.a.mark(function e(){var t;return b.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,ue();case 2:t=e.sent,a({payload:t,type:"POLL"});case 4:case"end":return e.stop()}},e)}));return function(){return e.apply(this,arguments)}}()()},[]),r.a.createElement("main",null,r.a.createElement(h.a,null,r.a.createElement(Y,null),r.a.createElement(E.c,null,r.a.createElement(E.a,{path:"/poll/:address/:option?",component:Ne}),r.a.createElement(E.a,{path:"/profile/:address",component:he}),r.a.createElement(E.a,{exact:!0,path:"/",component:we}),r.a.createElement(E.a,{path:"/logout",component:we}),r.a.createElement(E.a,{path:"/login",component:we}),r.a.createElement(E.a,{path:"/create",component:we}),r.a.createElement(E.a,{path:"/about",component:we}),r.a.createElement(E.a,null,r.a.createElement(xe,null)))))});o.a.render(r.a.createElement(function(e){var t=e.children,a=Object(n.useReducer)(function(e,t){switch(t.type){case"POLL":return Object(s.a)({},e,{polls:t.payload});case"WEB3":return Object(s.a)({},e,t.payload);default:return e}},i),c=Object(u.a)(a,2),o=c[0],l=c[1];return r.a.createElement(p,{value:{state:o,dispatch:l}},t)},null,r.a.createElement(l.a,{basename:"/"},r.a.createElement(n.Fragment,null,r.a.createElement(ke,null)))),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})}},[[269,2,1]]]);
//# sourceMappingURL=main.d8a4afbb.chunk.js.map